{% assign color = site.color %}
{% assign image = site.image %}

{% if page.tag %}
  {% assign tag = site.data.tags[page.tag] %}
  {% if tag.color %}{% assign color = tag.color %}{% endif %}
  {% if tag.image %}{% assign image = tag.image %}{% endif %}
{% else %}
  {% if page.tags.size > 0 %}
    {% assign tag_name = page.tags[0] %}
    {% assign tag = site.data.tags[tag_name] %}
    {% if tag.color %}{% assign color = tag.color %}{% endif %}
    {% if tag.image %}{% assign image = tag.image %}{% endif %}
  {% endif %}
{% endif %}

{% if page.color %}{% assign color = page.color %}{% endif %}
{% if page.image %}{% assign image = page.image %}{% endif %}

<!--[if gt IE 8]><!---->
<style>
  html {
    font-family: {{ site.font }};
  }

  :focus {
    outline-color: {{ color }};
  }

  h1, h2, h3, h4, h5, h6, .sidebar-nav {
    font-family: {{ site.font_heading }};
  }

  .content a,
  .related-posts li a:hover {
    color: {{ color }};
  }

  ::selection {
    color: #fff;
    background: {{ color }};
  }

  ::-moz-selection {
    color: #fff;
    background: {{ color }};
  }

  .sidebar {
    background-color: {{ color }};
  }

  {% if image != "none" %}
    .sidebar {
      background-image: url('{{ image }}');
    }
    .sidebar::before {
      /* make sidebar slightly darker to increase text readability (when using a background image) */
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
      right: 0;
      background: rgba(32, 32, 32, .33);
      background: -moz-linear-gradient(bottom, rgba(32,32,32,0) 0%, rgba(32,32,32,.5) 100%);
      background: -webkit-linear-gradient(bottom, rgba(32,32,32,0) 0%,rgba(32,32,32,.5) 100%);
      background: linear-gradient(to bottom, rgba(32,32,32,0) 0%,rgba(32,32,32,.5) 100%);
    }
  {% endif %}
</style>
<!--<![endif]-->
