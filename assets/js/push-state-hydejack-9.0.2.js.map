{"version":3,"sources":["webpack:///./_js/src/cross-fader.js","webpack:///./_js/src/flip/index.js","webpack:///./_js/src/flip/pro/project.js","webpack:///./_js/src/flip/title.js","webpack:///./_js/src/push-state.js"],"names":["RE_CSS_URL","calcHash","doc","sidebarBg","querySelector","pageStyle","innerText","trim","classList","style","backgroundImage","join","isExternal","protocol","host","location","window","objectURLs","WeakMap","CrossFader","constructor","fadeDuration","sidebar","document","getElementById","prevHash","themeColorEl","fetchImage2","newDocument","result","exec","of","url","URL","origin","fetchRx","href","method","headers","Accept","mode","pipe","switchMap","r","blob","map","createObjectURL","catchError","fetchImage","hash","empty","objectURL","div","createElement","set","updateStyle","themeColor","head","content","setTimeout","newPageStyle","parentNode","replaceChild","e","process","console","error","fade","prevDiv","insertBefore","nextElementSibling","animate","opacity","duration","easing","finalize","has","revokeObjectURL","get","removeChild","FLIP_TYPES","setupFLIP","start$","ready$","fadeIn$","options","other$","filter","flipType","includes","merge","setupFLIPTitle","setupFLIPProject","animationMain","settings","flip$","anchor","img","page","titleNode","title","textContent","h1","add","postDate","call","appendChild","placeholder","setAttribute","remove","transformOrigin","position","first","getBoundingClientRect","last","invertX","left","invertY","top","invertScale","width","transform","tap","complete","replaceEls","main","imgWrapper","zip","fromEvent","subscribe","TITLE_SELECTOR","firstFontSize","parseInt","getComputedStyle","fontSize","lastFontSize","x","Promise","all","Element","prototype","webComponentsReady","NAVBAR_SEL","MQ_STANDALONE","CROSS_FADE_DURATION","FADE_OUT","FADE_IN","setupAnimationMain","pushStateEl","importTemplate","previousElementSibling","setupLoading","navbarEl","lastElementChild","setupErrorPage","pathname","importBackButton","button","buttonEl","children","addEventListener","history","back","getFlipType","el","contains","getAttribute","Number","animateFadeOut","fill","mapTo","animateFadeIn","drawerEl","loadingEl","backBtnEl","standaloneMQ","matchMedia","standalone","navigator","matches","standalone$","fromMediaQuery","startWith","prepend","fromEventX","eventName","mapFn","detail","_","share","Object","assign","after$","progress$","error$","fadeOut$","context","pointerEvents","_noDrawer","exhaustMap","display","p","toPromise","transitionUntil","promise","timer","crossFader","takeUntil","pairwise","mergeMap","prev","curr","_pushState"],"mappings":"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","file":"push-state-hydejack-9.0.2.js","sourcesContent":["// Copyright (c) 2019 Florian Klampfer <https://qwtel.com/>\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport { empty, of } from 'rxjs';\nimport { catchError, finalize, map, switchMap } from 'rxjs/operators';\n\nimport { animate, fetchRx } from './common';\n\nconst RE_CSS_URL = /url\\s*\\(['\"]?(([^'\"\\\\]|\\\\.)*)['\"]?\\)/u;\n\n/** @param {Document} doc */\nconst calcHash = (doc) => {\n  const sidebarBg = doc.querySelector('.sidebar-bg');\n  const pageStyle = doc.querySelector('#_pageStyle');\n  // const rule = Array.from(pageStyle?.sheet?.rules ?? []).find(r => r.selectorText === 'html');\n  // const accentColor = rule?.style.getPropertyValue('--accent-color') ?? '';\n  // const themeColor = rule?.style.getPropertyValue('--theme-color') ?? '';\n  return [pageStyle?.innerText?.trim(), sidebarBg?.classList, sidebarBg?.style.backgroundImage].join('\\n');\n};\n\n/**\n * Consider a URL external if either the protocol, hostname or port is different.\n * @param {URL} param0\n * @param {Location=} location\n */\nfunction isExternal({ protocol, host }, location = window.location) {\n  return protocol !== location.protocol || host !== location.host;\n}\n\nconst objectURLs = new WeakMap();\n\nexport class CrossFader {\n  /** @param {number} fadeDuration */\n  constructor(fadeDuration) {\n    this.sidebar = document.getElementById('_sidebar');\n    this.fadeDuration = fadeDuration;\n    this.prevHash = calcHash(document);\n    this.themeColorEl = document.querySelector('meta[name=\"theme-color\"]');\n  }\n\n  /** @param {Document} newDocument */\n  fetchImage2(newDocument) {\n    const { backgroundImage = '' } = newDocument.querySelector('.sidebar-bg')?.style ?? {};\n    const result = RE_CSS_URL.exec(backgroundImage);\n    if (!result) {\n      return of('');\n    }\n\n    const url = new URL(result[1], window.location.origin);\n\n    return fetchRx(url.href, {\n      method: 'GET',\n      headers: { Accept: 'image/*' },\n      ...(isExternal(url) ? { mode: 'cors' } : {}),\n    }).pipe(\n      switchMap((r) => r.blob()),\n      map((blob) => URL.createObjectURL(blob)),\n      catchError(() => of(url.href)),\n    );\n  }\n\n  /** @param {Document} newDocument */\n  fetchImage(newDocument) {\n    const hash = calcHash(newDocument);\n    if (hash === this.prevHash) return empty();\n\n    return this.fetchImage2(newDocument).pipe(\n      map((objectURL) => {\n        /** @type {HTMLDivElement} */\n        const div = newDocument.querySelector('.sidebar-bg') ?? document.createElement('div');\n\n        if (objectURL) {\n          div.style.backgroundImage = `url(${objectURL})`;\n          objectURLs.set(div, objectURL);\n        }\n\n        return [div, hash, newDocument];\n      }),\n    );\n  }\n\n  /** @param {Document} newDocument */\n  updateStyle(newDocument) {\n    if (this.themeColorEl) {\n      const themeColor = newDocument.head.querySelector('meta[name=\"theme-color\"]')?.content;\n      if (themeColor) {\n        window.setTimeout(() => {\n          if (this.themeColorEl) {\n            this.themeColorEl.content = themeColor;\n          }\n        }, 250);\n      }\n    }\n\n    try {\n      const pageStyle = document.getElementById('_pageStyle');\n      const newPageStyle = newDocument.getElementById('_pageStyle');\n      if (!newPageStyle) return;\n      pageStyle?.parentNode?.replaceChild(newPageStyle, pageStyle);\n    } catch (e) {\n      if (process.env.DEBUG) console.error(e);\n    }\n  }\n\n  /**\n   * @param {[HTMLDivElement]} param0\n   * @param {[HTMLDListElement, string, Document]} param1\n   */\n  fade([prevDiv], [div, hash, newDocument]) {\n    prevDiv?.parentNode?.insertBefore(div, prevDiv.nextElementSibling);\n\n    this.updateStyle(newDocument);\n\n    // Only update the prev hash after we're actually in the fade stage\n    this.prevHash = hash;\n\n    return animate(div, [{ opacity: 0 }, { opacity: 1 }], {\n      duration: this.fadeDuration,\n      easing: 'ease',\n    }).pipe(\n      finalize(() => {\n        if (objectURLs.has(prevDiv)) URL.revokeObjectURL(objectURLs.get(prevDiv));\n        prevDiv?.parentNode?.removeChild(prevDiv);\n      }),\n    );\n  }\n}\n","// Copyright (c) 2019 Florian Klampfer <https://qwtel.com/>\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport { merge } from 'rxjs';\nimport { filter } from 'rxjs/operators';\n\nimport { setupFLIPTitle } from './title';\nimport { setupFLIPProject } from './pro/project';\n\nconst FLIP_TYPES = ['title', 'projects'];\n\nexport function setupFLIP(start$, ready$, fadeIn$, options) {\n  const other$ = start$.pipe(filter(({ flipType }) => !FLIP_TYPES.includes(flipType)));\n\n  return merge(\n    setupFLIPTitle(start$, ready$, fadeIn$, options),\n    setupFLIPProject(start$, ready$, fadeIn$, options),\n    other$,\n  );\n}\n","// Copyright (c) 2019 Florian Klampfer <https://qwtel.com/>\n\nimport { fromEvent, of, zip } from 'rxjs';\nimport { tap, finalize, filter, switchMap } from 'rxjs/operators';\n\nimport { animate, empty } from '../../common';\n\nexport function setupFLIPProject(start$, ready$, fadeIn$, { animationMain, settings }) {\n  if (!animationMain) return start$;\n\n  const flip$ = start$.pipe(\n    filter(({ flipType }) => flipType === 'project'),\n    switchMap(({ anchor }) => {\n      const img = anchor.querySelector('.flip-project-img');\n      if (!anchor || !img) return of({});\n\n      const page = animationMain.querySelector('.page');\n      if (!page) return of({});\n\n      const titleNode = anchor.parentNode.querySelector('.flip-project-title');\n      const title = (titleNode && titleNode.textContent) || '|';\n\n      const h1 = document.createElement('h1');\n      h1?.classList.add('page-title');\n      if (h1) h1.style.opacity = '0';\n      if (h1) h1.textContent = title;\n\n      const postDate = document.createElement('div');\n      postDate?.classList.add('post-date');\n      postDate?.classList.add('heading');\n      if (postDate) postDate.style.opacity = '0';\n      if (postDate) postDate.textContent = '|';\n\n      empty.call(page);\n      page.appendChild(h1);\n      page.appendChild(postDate);\n\n      const placeholder = document.createElement('div');\n      placeholder.setAttribute('class', img.classList);\n      placeholder.classList.remove('project-card-img');\n\n      img.parentNode.insertBefore(placeholder, img);\n      img.classList.add('lead');\n      img.style.transformOrigin = 'left top';\n\n      page.appendChild(img);\n      animationMain.style.position = 'fixed';\n      animationMain.style.opacity = '1';\n\n      const first = placeholder.getBoundingClientRect();\n      const last = img.getBoundingClientRect();\n\n      const invertX = first.left - last.left;\n      const invertY = first.top - last.top;\n      const invertScale = first.width / last.width;\n\n      const transform = [\n        {\n          transform: `translate3d(${invertX}px, ${invertY}px, 0) scale(${invertScale})`,\n        },\n        { transform: 'translate3d(0, 0, 0) scale(1)' },\n      ];\n\n      return animate(img, transform, settings).pipe(\n        tap({\n          complete() {\n            animationMain.style.position = 'absolute';\n          },\n        }),\n      );\n    }),\n  );\n\n  start$\n    .pipe(\n      switchMap(({ flipType }) =>\n        ready$.pipe(\n          filter(() => flipType === 'project'),\n          switchMap(({ replaceEls: [main] }) => {\n            const imgWrapper = main.querySelector('.aspect-ratio');\n            imgWrapper && (imgWrapper.style.opacity = 0);\n\n            const img = imgWrapper && imgWrapper.querySelector('img');\n\n            return zip(img ? fromEvent(img, 'load') : of({}), fadeIn$).pipe(\n              tap(() => (imgWrapper && (imgWrapper.style.opacity = 1), (animationMain.style.opacity = 0))),\n              switchMap(() =>\n                img != null ? animate(animationMain, [{ opacity: 1 }, { opacity: 0 }], { duration: 500 }) : of({}),\n              ),\n              finalize(() => (animationMain.style.opacity = 0)),\n            );\n          }),\n        ),\n      ),\n    )\n    .subscribe();\n\n  return flip$;\n}\n","// Copyright (c) 2019 Florian Klampfer <https://qwtel.com/>\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport { of, zip } from 'rxjs';\nimport { tap, finalize, filter, map, switchMap } from 'rxjs/operators';\n\nimport { animate, empty } from '../common';\n\nconst TITLE_SELECTOR = '.page-title, .post-title';\n\nexport function setupFLIPTitle(start$, ready$, fadeIn$, { animationMain, settings }) {\n  if (!animationMain) return start$;\n\n  const flip$ = start$.pipe(\n    filter(({ flipType }) => flipType === 'title'),\n    switchMap(({ anchor }) => {\n      if (!anchor) return of({});\n\n      const title = document.createElement('h1');\n\n      title.classList.add('page-title');\n      title.textContent = anchor.textContent;\n      title.style.transformOrigin = 'left top';\n\n      const page = animationMain.querySelector('.page');\n      if (!page) return of({});\n\n      empty.call(page);\n      page.appendChild(title);\n\n      animationMain.style.position = 'fixed';\n      animationMain.style.opacity = 1;\n\n      const first = anchor.getBoundingClientRect();\n      const last = title.getBoundingClientRect();\n      const firstFontSize = parseInt(getComputedStyle(anchor).fontSize, 10);\n      const lastFontSize = parseInt(getComputedStyle(title).fontSize, 10);\n\n      const invertX = first.left - last.left;\n      const invertY = first.top - last.top;\n      const invertScale = firstFontSize / lastFontSize;\n\n      anchor.style.opacity = 0;\n\n      const transform = [\n        {\n          transform: `translate3d(${invertX}px, ${invertY}px, 0) scale(${invertScale})`,\n        },\n        { transform: 'translate3d(0, 0, 0) scale(1)' },\n      ];\n\n      return animate(title, transform, settings).pipe(\n        tap({\n          complete() {\n            animationMain.style.position = 'absolute';\n          },\n        }),\n      );\n    }),\n  );\n\n  start$\n    .pipe(\n      switchMap(({ flipType }) =>\n        zip(\n          ready$.pipe(\n            filter(() => flipType === 'title'),\n            map(({ replaceEls: [main] }) => {\n              const title = main.querySelector(TITLE_SELECTOR);\n              if (title) title.style.opacity = 0;\n              return title;\n            }),\n          ),\n          fadeIn$,\n          (x) => x,\n        ).pipe(\n          tap((title) => {\n            if (title) title.style.opacity = 1;\n            animationMain.style.opacity = 0;\n          }),\n          finalize(() => {\n            animationMain.style.opacity = 0;\n          }),\n        ),\n      ),\n    )\n    .subscribe();\n\n  return flip$;\n}\n","// Copyright (c) 2019 Florian Klampfer <https://qwtel.com/>\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport { fromEvent, merge, timer, zip } from 'rxjs';\nimport {\n  tap,\n  exhaustMap,\n  map,\n  mapTo,\n  mergeMap,\n  pairwise,\n  share,\n  startWith,\n  switchMap,\n  takeUntil,\n} from 'rxjs/operators';\n\nimport { animate, empty, importTemplate, webComponentsReady, fromMediaQuery } from './common';\nimport { CrossFader } from './cross-fader';\nimport { setupFLIP } from './flip';\n\n(async () => {\n  await Promise.all([\n    ...('fetch' in window ? [] : [import(/* webpackChunkName: \"fetch\" */ './polyfills/fetch')]),\n    ...('customElements' in window\n      ? []\n      : [import(/* webpackChunkName: \"webcomponents\" */ './polyfills/webcomponents')]),\n    ...('animate' in Element.prototype ? [] : [import(/* webpackChunkName: \"webanimations\" */ 'web-animations-js')]),\n    ...('IntersectionObserver' in window\n      ? []\n      : [import(/* webpackChunkName: \"intersection-observer\" */ 'intersection-observer')]),\n  ]);\n\n  await webComponentsReady;\n\n  const NAVBAR_SEL = '#_navbar > .content > .nav-btn-bar';\n  const MQ_STANDALONE = '(display-mode: standalone)';\n\n  const CROSS_FADE_DURATION = 2000;\n\n  const FADE_OUT = [{ opacity: 1 }, { opacity: 0 }];\n  const FADE_IN = [\n    { opacity: 0, transform: 'translateY(-3rem)' },\n    { opacity: 1, transform: 'translateY(0)' },\n  ];\n\n  function setupAnimationMain(pushStateEl) {\n    pushStateEl?.parentNode?.insertBefore(importTemplate('_animation-template'), pushStateEl);\n    return pushStateEl?.previousElementSibling;\n  }\n\n  function setupLoading(navbarEl) {\n    navbarEl?.appendChild(importTemplate('_loading-template'));\n    return navbarEl?.lastElementChild;\n  }\n\n  function setupErrorPage(main, url) {\n    const { pathname } = url;\n    const error = importTemplate('_error-template');\n    const anchor = error?.querySelector('.this-link');\n    if (anchor) {\n      anchor.href = pathname;\n      anchor.textContent = pathname;\n    }\n    main?.appendChild(error);\n    return main?.lastElementChild;\n  }\n\n  function importBackButton() {\n    const button = importTemplate('_back-template');\n    const buttonEl = button?.children[0];\n    button?.querySelector('.nav-btn')?.addEventListener('click', () => window.history.back());\n    return buttonEl;\n  }\n\n  function getFlipType(el) {\n    if (el?.classList.contains('flip-title')) return 'title';\n    if (el?.classList.contains('flip-project')) return 'project';\n    return el?.getAttribute?.('data-flip');\n  }\n\n  const pushStateEl = document.querySelector('hy-push-state');\n  if (!pushStateEl) return;\n\n  const duration = Number(pushStateEl.getAttribute('duration')) || 350;\n  const settings = {\n    duration: duration,\n    easing: 'ease',\n  };\n\n  const animateFadeOut = ({ main }) => animate(main, FADE_OUT, { ...settings, fill: 'forwards' }).pipe(mapTo({ main }));\n\n  const animateFadeIn = ({ replaceEls: [main], flipType }) =>\n    animate(main, FADE_IN, settings).pipe(mapTo({ main, flipType }));\n\n  const drawerEl = document.querySelector('hy-drawer');\n  const navbarEl = document.querySelector(NAVBAR_SEL);\n\n  const animationMain = setupAnimationMain(pushStateEl);\n  const loadingEl = setupLoading(navbarEl);\n\n  const backBtnEl = importBackButton();\n  if (navbarEl && backBtnEl) {\n    const standaloneMQ = window.matchMedia(MQ_STANDALONE);\n    const standalone = !!navigator.standalone || standaloneMQ.matches;\n    const standalone$ = fromMediaQuery(standaloneMQ).pipe(\n      map((e) => e.matches),\n      startWith(standalone),\n    );\n    standalone$\n      .pipe(\n        tap((matches) => {\n          if (matches) navbarEl.prepend(backBtnEl);\n          else if (backBtnEl.parentNode === navbarEl) navbarEl.removeChild(backBtnEl);\n        }),\n      )\n      .subscribe();\n  }\n\n  const fromEventX = (eventName, mapFn) =>\n    fromEvent(pushStateEl, eventName).pipe(\n      map(({ detail }) => detail),\n      mapFn ? map(mapFn) : (_) => _,\n      share(),\n    );\n\n  const start$ = fromEventX('hy-push-state-start', (detail) =>\n    Object.assign(detail, { flipType: getFlipType(detail.anchor) }),\n  );\n  const ready$ = fromEventX('hy-push-state-ready');\n  const after$ = fromEventX('hy-push-state-after');\n  const progress$ = fromEventX('hy-push-state-progress');\n  const error$ = fromEventX('hy-push-state-networkerror');\n\n  const fadeOut$ = start$.pipe(\n    map((context) => Object.assign(context, { main: document.getElementById('_main') })),\n    tap(({ main }) => {\n      main.style.pointerEvents = 'none';\n    }),\n    window._noDrawer && drawerEl?.classList.contains('cover')\n      ? tap(() => {\n          drawerEl.classList.remove('cover');\n          drawerEl.parentNode?.appendChild(drawerEl);\n        })\n      : (_) => _,\n    exhaustMap(animateFadeOut),\n    tap(({ main }) => empty.call(main)),\n    share(),\n  );\n\n  if (loadingEl) {\n    progress$.subscribe(() => {\n      loadingEl.style.display = 'flex';\n    });\n    ready$.subscribe(() => {\n      loadingEl.style.display = 'none';\n    });\n  }\n\n  const fadeIn$ = after$.pipe(\n    switchMap((context) => {\n      const p = animateFadeIn(context).toPromise();\n      context.transitionUntil(p);\n      return p;\n    }),\n    share(),\n  );\n\n  const flip$ = setupFLIP(start$, ready$, merge(fadeIn$, error$), {\n    animationMain,\n    settings: settings,\n  }).pipe(share());\n\n  start$\n    .pipe(\n      switchMap((context) => {\n        const promise = zip(timer(duration), fadeOut$, flip$).toPromise();\n        context.transitionUntil(promise);\n        return promise;\n      }),\n    )\n    .subscribe();\n\n  // FIXME: Keeping permanent subscription? turn into hot observable?\n  fadeOut$.subscribe();\n  flip$.subscribe();\n\n  const sidebarBg = document.querySelector('.sidebar-bg');\n  if (sidebarBg) {\n    const crossFader = new CrossFader(CROSS_FADE_DURATION);\n    after$\n      .pipe(\n        switchMap(({ document }) =>\n          zip(crossFader.fetchImage(document), fadeIn$).pipe(\n            map(([x]) => x),\n            takeUntil(start$),\n          ),\n        ),\n        startWith([sidebarBg]),\n        pairwise(),\n        mergeMap(([prev, curr]) => crossFader.fade(prev, curr)),\n      )\n      .subscribe();\n  }\n\n  error$\n    .pipe(\n      switchMap(({ url }) => {\n        if (loadingEl) loadingEl.style.display = 'none';\n\n        const main = document.getElementById('_main');\n        if (main) main.style.pointerEvents = '';\n        empty.call(animationMain?.querySelector('.page'));\n        empty.call(main);\n\n        setupErrorPage(main, url);\n\n        return animate(main, FADE_IN, { ...settings, fill: 'forwards' });\n      }),\n    )\n    .subscribe();\n\n  import(/* webpackMode: \"eager\" */ '@hydecorp/push-state');\n\n  window._pushState = pushStateEl;\n})();\n"],"sourceRoot":""}